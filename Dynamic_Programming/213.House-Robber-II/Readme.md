### 213.House-Robber-II

#### 解法1：双状态动态规划
考虑环的影响，首位和末位不能同时为yes。这说明至少有一个的选择是no。

(1) 如果首位我们选择no，那么从nums[1]到nums[n-1]的选择就没有环形的首尾制约，完全就是一个198.House Robber I的问题。

(2) 如果末位我们选择no，那么从nums[0]到nums[n-2]的选择就没有环形的首尾制约，同样也是一个198.House Robber I的问题。

我们将两种情况下的最优解再取最大值，就是答案。

注意，(1)和(2)并不是互斥的。他们是有交叠的。但是它们的并集一定是全集。

#### 解法2：记忆化搜索（递归）
我们考虑是否打劫第零家（nums[0]）：是的话，那么下一步我们可以在[2,n-2]中任意选择打劫。如果不打劫第零家，那么下一步我们可以在[1,n-1]中任意选择打劫。也就是说，最顶层的答案就是```max( nums[0]+dfs(2,n-2), dfs(1,n-1) )```其中DFS的两个参数就是可供打劫的区间。这里特别注意的是n-2，这是因为题目中loop的要求（不能打劫任意相邻两家），打劫了第0家的话我们就不可能打劫第n-1家。

对于任意区间[i,j]作为打劫对象，我们可以同样处理，考虑是否打劫最前面的（也就是第i家）。根据不同的决策，我们分别有：```nums[i]+dfs(i+1,j)```和```dfs(i+1,j)```.两者分别递归处理得到结果后，取较大作为返回值。

当然，我们也可以用区间型的二维dp来实现上面的算法。

#### Follow-up
记忆化搜索虽然看上去不如第一种解法精妙，但是写法灵活，可以处理更多的问题。比如说有一个变种题：有一个数组表示一个环。如果你取了某个数，那么其两边的数会自动隐去。问这样操作直至所有的数都取完，最多能打劫多少钱？

此题和LC213相同的地方是，无论如何都不可能取到两个相邻的元素。不同的地方是多了一个条件：无论如何都不能取超过n/3个元素。所以此题的本质是：取任意n/3个互不相邻的数，求最大的和。

当然，我们需要验证一下，是不是任意的n/3个互不相邻的元素集合，都可以按照题目中的取数规则来实现。事实上是可以的。例如```1000101010000```，有13个元素。其中1代表我们打算取的数。我们永远先取较为外层的数（随之删去左右相邻的两个零）：原序列可以得到```0010101000```，接下来```0101000```，接下来```1000```，最后```0```.

可见这道题和House Robber II本质上一模一样。记忆化搜索的参考代码如下：
```cpp
class Solution {
    map<vector<int>,int>Map;
public:
    int rob(vector<int>& nums) 
    {
        if (nums.size()==0) return 0;
        int n = nums.size();
        return max(nums[0]+DFS(2,n-2,n/3-1,nums), DFS(1,n-1,n/3,nums));
    }
    
    int DFS(int i, int j, int k, vector<int>&nums)
    {
        if (k==0)
            return 0;
        
        if (j-i+1<k*2-1) return INT_MIN;
        
        if (Map.find({i,j,k})!=Map.end())
            return Map[{i,j,k}];
            
        if (k==1)
        {
            int mx = -1;
            for (int t=i; t<=j; t++)
                mx = max(mx, nums[t]);
            Map[{i,j,k}] = mx;
            return mx;            
        }            
        
        int ret = max(nums[i]+DFS(i+2,j,k-1,nums), DFS(i+1,j,k,nums));
        
        Map[{i,j,k}] = ret;
        
        return ret;
    }
};
```


[Leetcode Link](https://leetcode.com/problems/house-robber-ii)